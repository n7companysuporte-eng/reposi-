<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Estoque</title>

<style>
:root{
  --roxo:#6c4cff;
  --roxo-escuro:#4b35c9;
  --cinza:#f4f5fa;
  --preto:#0f0f1a;
  --branco:#fff;
  --verde:#2ecc71;
  --amarelo:#f1c40f;
  --vermelho:#e74c3c;
}

*{box-sizing:border-box;font-family:Inter,system-ui}

body{margin:0;background:var(--cinza);color:var(--preto)}

header{
  background:linear-gradient(135deg,var(--roxo),var(--roxo-escuro));
  color:#fff;
  padding:20px;
}

.container{max-width:480px;margin:auto;padding:16px}

.tabs{
  display:flex;
  gap:8px;
  margin-bottom:16px;
}

.tabs button{
  flex:1;
  padding:10px;
  border:none;
  border-radius:14px;
  background:#ddd;
  font-weight:600;
}

.tabs button.active{
  background:var(--roxo);
  color:#fff;
}

.card{
  background:#fff;
  border-radius:20px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.05);
}

input,select,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:12px;
  border:1px solid #ddd;
}

button.primary{
  background:var(--roxo);
  color:#fff;
  border:none;
  font-weight:600;
}

.list{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 0;
  border-bottom:1px solid #eee;
}

.badge{padding:4px 10px;border-radius:20px;color:#fff;font-size:12px}
.ok{background:var(--verde)}
.atencao{background:var(--amarelo)}
.critico{background:var(--vermelho)}

.hidden{display:none}
small{opacity:.6}
pre{white-space:pre-wrap;font-size:13px}
</style>
</head>

<body>

<header>
  <h2>üì¶ Controle de Estoque</h2>
  <small>Vis√£o clara, simples e profissional</small>
</header>

<div class="container">

<div class="tabs">
  <button class="active" onclick="trocar('estoque')">Estoque</button>
  <button onclick="trocar('mov')">Movimentar</button>
  <button onclick="trocar('hist')">Hist√≥rico</button>
  <button onclick="trocar('ana')">An√°lise</button>
</div>

<!-- ESTOQUE -->
<div id="estoque" class="card">
  <h3>Produtos em estoque</h3>
  <div id="listaEstoque"></div>

  <h4>Adicionar produto</h4>
  <input id="nome" placeholder="Produto">
  <input id="categoria" placeholder="Categoria">
  <input id="qtd" type="number" placeholder="Quantidade inicial">
  <button class="primary" onclick="addProduto()">Adicionar</button>
</div>

<!-- MOVIMENTAR -->
<div id="mov" class="card hidden">
  <h3>Movimenta√ß√£o</h3>
  <select id="prodMov"></select>
  <select id="tipo">
    <option value="entrada">Entrada</option>
    <option value="saida">Sa√≠da</option>
  </select>
  <input id="qtdMov" type="number" placeholder="Quantidade">
  <button class="primary" onclick="movimentar()">Registrar</button>
</div>

<!-- HIST√ìRICO -->
<div id="hist" class="card hidden">
  <h3>Hist√≥rico</h3>
  <div id="historico"></div>
</div>

<!-- AN√ÅLISE -->
<div id="ana" class="card hidden">
  <h3>An√°lise por per√≠odo</h3>
  <input type="date" id="ini">
  <input type="date" id="fim">
  <button class="primary" onclick="gerarResumo()">Gerar an√°lise</button>
  <pre id="resumo"></pre>
  <button onclick="enviarResumo()">Enviar WhatsApp</button>
</div>

</div>

<script>
let produtos = JSON.parse(localStorage.getItem("produtos")) || [];
let historico = JSON.parse(localStorage.getItem("historico")) || [];

function salvar(){
  localStorage.setItem("produtos",JSON.stringify(produtos));
  localStorage.setItem("historico",JSON.stringify(historico));
  render();
}

function trocar(id){
  document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
}

function status(q){
  if(q<=2) return ['critico','Cr√≠tico'];
  if(q<=5) return ['atencao','Aten√ß√£o'];
  return ['ok','OK'];
}

function render(){
  listaEstoque.innerHTML="";
  prodMov.innerHTML="";
  historico.innerHTML="";

  produtos.forEach(p=>{
    const s=status(p.qtd);
    listaEstoque.innerHTML+=`
    <div class="list">
      <div>
        <strong>${p.nome}</strong><br>
        <small>${p.cat}</small>
      </div>
      <span class="badge ${s[0]}">${p.qtd} ‚Ä¢ ${s[1]}</span>
    </div>`;
    prodMov.innerHTML+=`<option value="${p.id}">${p.nome}</option>`;
  });

  historico.slice().reverse().forEach(h=>{
    historico.innerHTML+=`
    <div class="list">
      <div>
        <strong>${h.produto}</strong><br>
        <small>${h.tipo} ‚Ä¢ ${h.data}</small>
      </div>
      <span class="badge ok">${h.qtd}</span>
    </div>`;
  });
}

function addProduto(){
  const d=new Date().toLocaleString();
  const p={id:Date.now(),nome:nome.value,cat:categoria.value,qtd:+qtd.value||0};
  produtos.push(p);
  historico.push({produto:p.nome,tipo:"cria√ß√£o",qtd:p.qtd,data:d});
  nome.value=categoria.value=qtd.value="";
  salvar();
}

function movimentar(){
  const p=produtos.find(p=>p.id==prodMov.value);
  let q=+qtdMov.value;
  if(tipo.value==="saida") q*=-1;
  p.qtd+=q;
  historico.push({produto:p.nome,tipo:tipo.value,qtd:q,data:new Date().toLocaleString()});
  qtdMov.value="";
  salvar();
}

function gerarResumo(){
  resumo.textContent=`üì¶ RESUMO DE ESTOQUE\nProdutos: ${produtos.length}\nMovimenta√ß√µes: ${historico.length}`;
}

function enviarResumo(){
  window.open(`https://wa.me/?text=${encodeURIComponent(resumo.textContent)}`);
}

render();
</script>

</body>
</html>
